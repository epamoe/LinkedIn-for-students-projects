{% extends 'base.html' %}

{% block content %}
    <form method="post" id="com">
    {% csrf_token %}
    <div style="width: 300px; margin: 100px;">
        {{ comment.title }}
            {{errors}}
    <input type="submit" class="btn btn-primary" value="commenter">
    </div>
    <br>

    {% for comment in comments %}
        <div class="" id="container">
            <p id="title">{{ comment.title}}</p>
        </div>
        
    {% endfor %}
    
</form>

<script>
     let form = document.getElementById('com');
     
     let container = document.getElementById('container')
     form.addEventListener('submit', StopReload)
     function StopReload(e){
       e.preventDefault();
       let title = document.createElement('p');
        $.ajax({
            type: "POST",
            url: "{% url 'comments' %}",
            data: $('#com').serialize(),
            dataType: "json",

            success:function(data){
                  title.innerText = data.new_comment;
                  container.appendChild(title)
                  form.reset()
                    }
            })
   }

</script>


<div id="myModal" class="modal">
  <!-- Modal content -->
  <div class="modal-content">
  	<div class="close">x</div>
  	<h3 class="titre_modal"> Poster un Projet</h3>
  	<div class="trait"></div>
  		<div class="form">
      <form method="post" enctype="multipart/form-data">
                 {% csrf_token %}
      			<div class="champs">
		       	{{ projet_form.title }}
		       	<p><span id='error_title'></span></p>

		       	{{ projet_form.categorie }}
		       	<p><span id="errror_categorie"></span></p>
		       	
		      	<textarea name="description" cols="40" rows="10" maxlength="500" placeholder="Decrivez votre  projet en quelques lignes" required="" id="id_description"></textarea>
		       	<p><span id="errror_description"></span></p>
		       	
		        <!-- div ou s'affichera la previsualisation de l'image ou du ficier -->

		        <div id="img-show" style="display: none;margin-bottom: 5px;height: 100px; width: 350px; border: #ced4da solid 1px;">
		        	<div style="margin: 20px 0 0 165px; height: 30px; width: 30px; background: bisque; border-radius: 20px; font-size: 2em;">+</div>
		        </div>
		        <div id="file-show" style="display: none;margin-bottom: 5px;height: 100px; width: 350px; border: #ced4da solid 1px;">
		        	
		        </div>
		        <!-- div permettant de choisir d'oujouter une image ou un fichier -->
		        <div class="image">
		        	
		        	<span class='btn'>ajouter une image</span> <img id="img" src="image.png" height="20" width="20">  <img id='file' height="20" width="20" src="file.png">
		        </div>
                <div>
                    <select name="etudiant" style="display: none;" required="" id="id_etudiant">

                            <option value="{{ request.user.etudiant.id }}">{{ request.user.etudiant }}</option>

                        </select>
                </div>
		        <div>
		        	<input class="btn1" type="submit" onclick="validatePost()" name="" value="Publier">
		        </div>
		        {{ err }}
		        
      </div>
      </form>
    </div>
  </div>
</div>

{% endblock %}